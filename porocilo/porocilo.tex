\documentclass[11pt,a4paper]{article}

\usepackage[slovene]{babel}
\usepackage[utf8x]{inputenc}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{pdfpages}

\pagestyle{plain}

\begin{document}

\begin{titlepage}
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}
\center

\textsc{\LARGE Fakulteta za matematiko in fiziko}\\[3 cm]
\textsc{\Large Poročilo pri predmetu}\\[0.5cm]
\textsc{\large Analiza podatkov s programom R}\\[2 cm]
\HRule \\[0.4cm]
{ \huge \bfseries ZDA - populacija}\\[0.4cm] 
\HRule \\[6 cm]


\begin{minipage}{0.4\textwidth}
\begin{flushleft} \large
\emph{Avtor:}\\
Rok \textsc{Zadravec}
\end{flushleft}
\end{minipage}
~
\begin{minipage}{0.4\textwidth}
\begin{flushright} \large
\emph{Mentor:} \\
Dr. Janoš \textsc{Vidali}
\end{flushright}
\end{minipage}\\[2 cm]

{\large \today}\\[3cm] 


\end{titlepage}

\section{Izbira teme}

Tema mojega projekta je analiza vseh posameznih držav iz ZDA. V projektu bom za vsako državo podal njeno glavno mesto, največje mesto, njeno površino, njeno površino zemlje, njeno populacijo in če po velikosti sodi med večje ali manjše. Po potrebi bom še dodajal druge zadeve, ki bi se mi zdele zanimive za nadaljno analizo.

Zanimalo me je prebivalstvo v združenih državah. Moj cilj je pridobiti vsaj okvirno idejo o porazdelitvi prebivalstva v ZDA (območja z večjo poseljenostjo) prav tako kot o samih lastnostih posameznih držav. Zanimivo se mi je zdelo tudi pogledati kako se je spreminjala količina
prebivalstva v celotnih ZDA.

Podatke sem pridobil na straneh Wikipedie \url{http://en.wikipedia.org/wiki/List_of_states_and_territories_of_the_United_States}, \url{http://en.wikipedia.org/wiki/List_of_U.S._states_and_territories_by_population} in \url{http://en.wikipedia.org/wiki/Demographics_of_the_United_States}.

\pagebreak

\section{Obdelava, uvoz in čiščenje podatkov}

Podatke sem uvozil v obliki csv (comma-separated value - podatki ločeni z vejico). Te podatke sem imel predhodno shranjene v Excel-ovi tabeli. Podatki so pridobljeni s strani \url{http://en.wikipedia.org/wiki/List_of_U.S._states_and_territories_by_population}. \\

Nekatere podatke sem zaradi preglednosti odstranil, tabeli pa prav tako dodal stolpce s podatki najdenimi na več različnih straneh. Tabeli sem tudi dodal urejenostno spremenljivko velikosti, ki za državo pove ali je večja ali manjša. Vse to (odstranjevanje, dodajanje in urejanje) sem naredil v Excelu. Excelova tabela v obliki csv je shranjena v mapi "Podatki".\\

Uvoza iz CSV v nadaljnem analiziranju podatkov ne uporabljam, ampak ga imam vključenega. Na začetku sem ga nameraval uporabiti, a je prišlo do spremembe.
Kot CSV datoteka je uvožena tudi celotna populacije v ZDA po letih.\\

Prav tako je narejen uvoz iz XML (s strani \url{http://en.wikipedia.org/wiki/List_of_states_and_territories_of_the_United_States}), ki se opravi ob zagonu programa uvoz.r. V tabelo sem dodal več spremenljivk, med njimi eno urejenostno in tri številske, ki se mi jih je zdelo pomembno 
izpostaviti. Urejenostna spremenljivka je v stolpcu "Size", ki države glede na velikost razdeli na 3 kategorije. Dodal sem še gostoto prebivalstva (izračunana iz podatkov, ki sem jih že imel v tabeli), prav tako kot delež površine kopnega v državi in gostoto prebivalstva če namesto celotne površine države gledamo samo površino kopnega. To tabelo tudi uporabljam v nadaljnih fazah.\\

V tej fazi sem še izdelal graf, natančneje histogram, držav glede na populacijo in glede na površino.
Graf populacije je razvrščen po populaciji v padajočem vrstem redu, graf površine določenih držav pa je razvrščen po abecednem redu.
Kot zanimivost je dodan tudi graf populacije celotne ZDA od leta 1935 pa do leta 2013. 

Grafe poženemo z programom grafi.R, ki je v mapi Slike. Pdf slike grafov sta shranjeni v 
grafi.pdf ter grafi2.pdf in grafi3.pdf.

\pagebreak 

Tabela ZDA vsebuje 11 stolpcev. Za vsako državo so podani naslednji podatki:

\begin{itemize}
  \item V stolpcu Abbr. se nahaja okrajšava za ime države. Spremenljivka je imenska.
  \item V stolpcu Capital so podana glavna mesta, ki so prav tako imenska spremenljivka.
  \item Stolpec Largest.city sestavljajo največja mesta posameznih držav. Spemenljivka je imenska.
  \item V stolpcu Population..2013.est. so podatki o populaciji držav (poračunano v letu 2013), ki je številska spremenljivka.
  \item Stolpec Total.area.in.mi2..km2 vsebuje podatek o velikosti države (v kvadratnih miljah). Ta spremenljivka je prav tako številska.
  \item Stolpca Land.area.in.mi2..km2. in Water.area.in.mi2..km2. vsebujeta podatke o površini kopnega oz. vode v državah. Spremenljivki sta številski.
  \item Stolpec Size, ki sem ga sam dodal, razvrsti države v 3 kategorije po površini ($<50000 mi^2$, med 50000 in 100000 $mi^2$ ter $>100000 mi^2$). Ta spremenljivka je urejenostna.
  \item Spremenljivki Pop.Density in Pop.Density.per.Land.area povesta kako gosto je država poseljena, edina razlika med njima je, da ena gleda celotno površino, druga pa samo površino kopnega. Spremenljivki sta obe številski.
  \item Zadnji stolpec je Percentage.of.Land.area, ki preprosto pove kolikšen del površine predstavlja kopno, spremenljivka je številska.
\end{itemize}

Tabela USA vsebuje samo 2 stolpca, v katerih so naslednji podatki:

\begin{itemize}
  \item Stolpec Year vsebuje letnice od 1935 pa do 2013, je številska spremenljivka.
  \item Stolpec Population.x1000 ima podatke za populacije celotne ZDA za posamezno leto. Zaradi preglednosti so podatki deljeni s 1000. Spremenljivka je številska.
\end{itemize}

\pagebreak

\includegraphics[width=\textwidth]{../slike/grafi2.pdf}

V grafu je prikazano število prebivalstva za posamezne države v ZDA. Države so razporejene po količini prebivalstva v padajočem vrstenem redu. Na grafu se lepo vidi kako 4 največje države "prehitevajo" ostale po populaciji.

\includegraphics[width=\textwidth]{../slike/grafi.pdf}

Graf velikosti posameznih zveznih držav (podan v kvadratnih miljah). Države si sledijo po abecednem vrstnem redu. Po velikosti sta od drugih dosti večja Aljaska in Texas.

\includegraphics[width=\textwidth]{../slike/grafi3.pdf}

Graf predstavlja prebivalstvo v ZDA v zadnjih 80-ih letih. Populacija je podana v milijonih.
V zadnjih 80ih letih je število prebivalstva raslo precej enakomerno, razen v letu 1945, kar pa lahko predvidevamo da je posledica II. svetovne vojne.

\pagebreak

\section{Analiza in vizualizacija podatkov}

Odločil sem se, da bom na začetku države analiziral zgolj glede na število prebivalcev. Uvozil sem zemljevid zveznih držav(datoteka dostopna na \url{http://biogeo.ucdavis.edu/data/gadm2/shp/USA_adm.zip}). Če bi izrisal zemljevid vseh zveznih držav (vključno z Aljasko in Havaji) ne bi bilo dobro. Torej sem se odločil, da izpustim Aljasko, Havaje Porto Rico in Deviške otoke zaradi
preglednosti. \\
V tej fazi sem izrisal zemljevid, ki je izrisal zgolj meje posameznih držav.
Zemljevid je pobarvan s štirimi barvami. Države so glede na populacijo razdeljene na štiri enako velike skupine, vsaka od teh skupin pa je svoje barve.\\
Poiskal sem datoteko, ki je vsebovala vse zvezne države in njihova pripadajoča glavna mesta. Glavna mesta so podana z zemljepisno dolžino in širino. Ti podatki so shranjeni v Excelovi datoteki uscapitals.csv. To mi je omogočilo, da sem na zemljevidu označil glavna mesta vseh držav in jim pripisal imena. \\
V nekaterih manjših državah sem izpustil ime glavnega mesta, saj je prišlo do prekrivanja imen. Če bi še zmanjšal samo velikost imen, jih ne bi bilo možno več razbrati, zato jih je bilo treba izpustiti. Ne glede na to, da ime glavnega mesta ni več napisano pa je točka, kjer se glavno mesta nahaja še vedno vključena na zemjevid. Imena glavnih mest sem pa izpustil tako, da sem v CSV datoteki za te države namesto imena glavnega mesta naredil prazen prostor.

\makebox[\textwidth][c]{
\includegraphics[width=1.2\textwidth]{../slike/drzave_zda.pdf}
}

Pobarvan zemljevid zveznih držav s pripadajočimi glavnimi mesti. Kot lahko vidimo, velikost države ni direktno povezana z njeno populacijo, saj imajo ene izmed večjih držav populacijo v zadnji (najmanjši) skupini.

\newpage
\section{Napredna analiza podatkov}

Zanimalo me je kako je populacija ZDA naraščala v letih za katere imam podatke. Iz tega tudi želim napovedati kako bo populacija naraščala v prihodnje. \\
Na grafu sem zapisal funkciji, populacije v odvisnosti od let, v primerih ko je odvisnost linearna in pa kvadratna. V vektor ostanki nam pove kako dobro je prileganje. Izračunanan je vsota kvadratov razdalj od napovedanih do dejanskih vrednosti. Kar pomeni, manjši kot je ostanek, boljše se naš model prilega dejanskemu grafu. Vidimo, da se model kvadratna boljše prilega našemu grafu. \\
S temi podatki želimo napovedati populacijo v prihajajočih letih. Naš graf "raztegnemo" na x-osi, tako da zajame leta od 1935 pa vse do 2050. To pomeni, da napovedujemo za naslednjih 35 let.
Z uporabo funkcije predict napišemo novo funkcijo, ki bo napovedala podatke v odvisnosti od modela, ki ga uporabimo.\\
Izrišemo napoved za rast populacije po kvadratnem in linearnem modelu.

\includegraphics[width=10.5cm]{../slike/napoved.pdf}

Na grafu je z rdečo označena pričakovana rast prebivalstva po kvadratni metodi, z modro pa pričakovana rast po linearni metodi. Kot vidimo, se kvadratna našim podatkom boljše prilega in napoveduje hitrejšo rast v prihodnje.\\

Naprej me je zanimalo kje v Ameriki so bolj gosto poseljena območja. Prav zaradi tega sem v tabelo dodal stolpev Pop.Denstity. Ker me v tej fazi ne zanima gostota prebivalstva v določeni državi na samem zemljevidu ni nobenih imeh. Narisal sem še en zemljevid ZDA in ga pobarval v skladu z gostoto prebivalstva v državah.

\makebox[\textwidth][c]{
\includegraphics[width=1.2\textwidth]{../slike/gostota.pdf}
}

Graf je pobarvan glede na gostoto prebivalstva v državah. Temnejša območja predstavljajo bolj poseljena območja. Vidimo, da so bolj poseljena območja skoraj izključno na obalah. Vzhodna obala je najgosteje poseljena. Na strani Wikipedie (\url{http://en.wikipedia.org/wiki/East_Coast_of_the_United_States}) je navedeno, da v državah, ki imajo obalo na vzhodnem delu živi dobra tretjina celotnega prebivalstva.\\

Naslednja stvar, ki sem jo opravil, je bil k-means clustering. Uporabil sem podatke o populaciji in gostoti prebivalstva. Uporabil sem funkcijo kmeans, in za število središč sem si izbral 3.
V spremenljivki center in skupina sem shranil vrednosti, ki jih po k-means clustering-u središča zavzamejo in pa v katero skupino vsaka država pripada.\\

Narisal sem graf gostote prebivalstva v odvisnosti od populacije države. Ko sem imel poračunane podatke katera država spada v katero skupino sem vsako skupino na grafu pobarval s svojo barvo. Z dodatno barvo sem označil še središče vsake skupine na grafu.\\

\includegraphics[width=10.5cm]{../slike/clustering.pdf}


\end{document}
